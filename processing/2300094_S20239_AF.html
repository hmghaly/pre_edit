<!DOCTYPE html>
<html lang="en">
<head>
  <title>Pre-editing Data Display</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.4/dist/jquery.slim.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>


  
  <script src="https://hmghaly.github.io/script.js"></script> 

</head>
<style type="text/css">
del {
    text-decoration: line-through;
    background-color: #fbb;
    color: #555;
}

ins {
    text-decoration: none;
    background-color: #d4fcbc;
}


.from_repl {
    text-decoration: line-through;
    background-color: #fbb;
    color: #555;
}

.to_repl {
    text-decoration: none;
    background-color: #d4fcbc;
}

.to_appoved {
  display : inline;
}
.to_rejected {
/*  visibility : "hidden";*/
  display : none;
}

.from_appoved {
  display : none;
}
.from_rejected {
  display : inline;
}

.tentative {
  border-style: groove;
  border-width: 2px;
  padding: 2px;
}

.approved {
  border-style: groove;
  border-color: green;
  background-color: #d4fcbc;
  border-width: 2px;
  padding: 2px;
}

.rejected {
  border-style: groove;
  border-color: red;
  border-width: 2px;
  padding: 2px;
}

.selected {
  border-style: solid;
  border-color: blue;
  border-width: 2px;
  padding: 2px;
}



blockquote {
    padding-left: 15px;
    border-left: 3px solid #d7d7db;
    font-size: 1rem;
}

footer {
    position: fixed;
    background-color: Beige;
    height: 60px;
    bottom: 0;
    width: 100%;
}

.footer_spacer{
  height: 60px;
}
  
</style>

<script type="text/javascript">

var el_i=0
var el_list=[]
var select_el_id=""
var qs_dict=parse_qs()


function init(){
  console.log("init")
  el_list=get_all_tentative_ids()//cur_classes.map(x => x.innerHTML)
  console.log(el_list)
  display_counts()
  select_el_id=el_list[el_i]
  select_el(select_el_id)
  update_ui()


  //identify all tentative replacemnet elements - get their ids
  //update count of repl_count
  //select first element - update corresponding element and cur_repl_number
  //set current counter
}  

function update_ui(){
  update_repl_display()
  display_counts()
}

function update_repl_display(){
  try {
    pair_to_accept=get_repl_pair(select_el_id) 
  } 
  catch(err) {
    pair_to_accept=""
  } 
  pair_to_accept=pair_to_accept.replace("|","⇨")
  pair_to_accept=repl(pair_to_accept,"_se_","&lt;/s&gt;") //pair_to_accept.replace("_se_","&lt;/s&gt;")
  pair_to_accept=repl(pair_to_accept,"_ss_","&lt;s&gt;") //pair_to_accept.replace("_ss_","&lt;s&gt;")

  $$("cur_repl_display").innerHTML=pair_to_accept

}

function go2prev_repl(){
  console.log("go2prev_repl")
  el_i-=1
  if (el_i<0) el_i=len(el_list)-1
  if (len(el_list)==0) return
  select_el_id=el_list[el_i]
  select_el(select_el_id)
  //display_counts()
  update_ui()

  //inc el_counter 
  //update counts
  //updated selected 

}  

function go2next_repl(){
  console.log("go2next_repl")
  el_i+=1
  if (el_i>=len(el_list)) el_i=0 //len(el_list)-1
  if (len(el_list)==0) return
  select_el_id=el_list[el_i]
  select_el(select_el_id)
  //display_counts()
  update_ui()
  
}  

function accept_repl_all(){
  cur_decision_dict={"decision":"accept_all","all":true}
  accept_reject(cur_decision_dict)
}

function reject_repl_all(){
  cur_decision_dict={"decision":"reject_all","all":true}
  accept_reject(cur_decision_dict)
}

function accept_repl(){
  cur_decision_dict={"decision":"accept","all":false}
  accept_reject(cur_decision_dict)
}

function reject_repl(){
  cur_decision_dict={"decision":"reject","all":false}
  accept_reject(cur_decision_dict)
}


function accept_reject(repl_outcome_dict){
  decision0=repl_outcome_dict["decision"]
  apply_to_all=repl_outcome_dict["all"] || false
  affected=[]
  if (decision0=="accept" || decision0=="accept_all") out_dict=accept_process(apply_to_all)
  if (decision0=="reject" || decision0=="reject_all") out_dict=reject_process(apply_to_all) 
  repl_outcome_dict["affected"]=out_dict["affected"] || 0 //len(affected) 
  repl_outcome_dict["repl"]=out_dict["repl"] || ""
  repl_outcome_dict["link"]=qs_dict["link"]
  console.log(repl_outcome_dict)
  //send to backend
  //update UI
  el_list=get_all_tentative_ids()
  el_i=el_list.indexOf(select_el_id)
  console.log(el_list)
  select_el(select_el_id)
  //display_counts()
  update_ui()
  post_data_async("log_repl",repl_outcome_dict)

}


function accept_process(do_accept_all){
  el_list=get_all_tentative_ids()
  if (len(el_list)==0) return {}

  pair_to_accept=get_repl_pair(select_el_id)
  console.log(pair_to_accept)
  console.log(el_list)
  if (!do_accept_all){
    ids_to_approve=[select_el_id]
  }
  else {
    ids_to_approve=[]
    for (id0 of el_list){
      corr_repl_pair=get_repl_pair(id0)
      if (str(corr_repl_pair)==str(pair_to_accept)) ids_to_approve.push(id0)
    }
  }
  console.log("ids_to_approve",ids_to_approve)
  el_i=el_list.indexOf(select_el_id) //identify next element after the approval of current
  next_i=0
  for (var i0=el_i; i0<len(el_list);i0++){
    next_el_id=el_list[i0]
    if (is_in(next_el_id,ids_to_approve)) continue
    else {
      select_el_id=next_el_id
      //el_i=i0
      break
    } 
  }

  for (approved_id0 of ids_to_approve) apply_accept(approved_id0)
  approved_out_dict={}
  approved_out_dict["affected"]=len(ids_to_approve)
  approved_out_dict["repl"]=pair_to_accept
  return approved_out_dict
}

function reject_process(do_reject_all){
  console.log("reject_repl")
  el_list=get_all_tentative_ids()
  if (len(el_list)==0) return {}

  pair_to_reject=get_repl_pair(select_el_id)
  console.log(pair_to_reject)
  //console.log(el_list)
  if (!do_reject_all){
    ids_to_reject=[select_el_id]
  }
  else {
    ids_to_reject=[]
    for (id0 of el_list){
      corr_repl_pair=get_repl_pair(id0)
      if (str(corr_repl_pair)==str(pair_to_reject)) ids_to_reject.push(id0)
    }
  }


  console.log("ids_to_reject",ids_to_reject)
  el_i=el_list.indexOf(select_el_id)
  next_i=0
  for (var i0=el_i; i0<len(el_list);i0++){
    next_el_id=el_list[i0]
    if (is_in(next_el_id,ids_to_reject)) continue
    else {
      select_el_id=next_el_id
      //el_i=i0
      break
    } 
  }

  for (rejected_id0 of ids_to_reject) apply_reject(rejected_id0)
  rejected_out_dict={}
  rejected_out_dict["affected"]=len(ids_to_reject)
  rejected_out_dict["repl"]=pair_to_accept
  return rejected_out_dict

}


function accept_repl_OLD(){
  console.log("accept_repl")
  el_list=get_all_tentative_ids()
  if (len(el_list)==0) return

  pair_to_accept=get_repl_pair(select_el_id)
  console.log(pair_to_accept)
  console.log(el_list)
  ids_to_approve=[]

  for (id0 of el_list){
  	corr_repl_pair=get_repl_pair(id0)
  	if (str(corr_repl_pair)==str(pair_to_accept)) ids_to_approve.push(id0)

  }
  console.log("ids_to_approve",ids_to_approve)
  el_i=el_list.indexOf(select_el_id)
  next_i=0
  for (var i0=el_i; i0<len(el_list);i0++){
  	next_el_id=el_list[i0]
  	if (is_in(next_el_id,ids_to_approve)) continue
  	else {
  		select_el_id=next_el_id
  		//el_i=i0
  		break
  	} 
  }

  for (approved_id0 of ids_to_approve) apply_accept(approved_id0)

  el_list=get_all_tentative_ids()
  el_i=el_list.indexOf(select_el_id)
  console.log(el_list)
  select_el(select_el_id)
  display_counts()
  //remove el id from id list
  //remove slected from el
  //change tentative to approved
  //change child from_repl > from_accepted
  //change child to_repl > to_accepted
  //update counts and displayed counts
}  


function reject_repl_OLD(){
  console.log("reject_repl")
  el_list=get_all_tentative_ids()
  if (len(el_list)==0) return

  pair_to_reject=get_repl_pair(select_el_id)
  console.log(pair_to_reject)
  //console.log(el_list)
  ids_to_reject=[]

  for (id0 of el_list){
  	corr_repl_pair=get_repl_pair(id0)
  	if (str(corr_repl_pair)==str(pair_to_reject)) ids_to_reject.push(id0)

  }
  console.log("ids_to_reject",ids_to_reject)
  el_i=el_list.indexOf(select_el_id)
  next_i=0
  for (var i0=el_i; i0<len(el_list);i0++){
  	next_el_id=el_list[i0]
  	if (is_in(next_el_id,ids_to_reject)) continue
  	else {
  		select_el_id=next_el_id
  		//el_i=i0
  		break
  	} 
  }

  for (rejected_id0 of ids_to_reject) apply_reject(rejected_id0)

  el_list=get_all_tentative_ids()
  el_i=el_list.indexOf(select_el_id)
  console.log(el_list)
  select_el(select_el_id)
  display_counts()  
  //remove el id from id list
  //remove slected from el
  //change tentative to rejected
  //change child from_repl > from_rejected
  //change child to_repl > to_rejected
  //update counts and displayed counts

}  

function undo_repl(){
  console.log("undo_repl")
}  

function apply_accept(cur_id){
	cur_el=$$(cur_id)
	cur_el.classList.remove("tentative")
	cur_el.classList.add("approved")

	from_el=cur_el.getElementsByClassName("from_repl")[0]
	to_el=cur_el.getElementsByClassName("to_repl")[0]
	from_el.classList.remove("from_repl")
	from_el.classList.add("from_appoved");
	to_el.classList.remove("to_repl")
	to_el.classList.add("to_appoved")
	console.log("applied accept")	
}


function apply_reject(cur_id){
	cur_el=$$(cur_id)
	cur_el.classList.remove("tentative")
	cur_el.classList.add("rejected")

	from_el=cur_el.getElementsByClassName("from_repl")[0]
	to_el=cur_el.getElementsByClassName("to_repl")[0]
	from_el.classList.remove("from_repl")
	from_el.classList.add("from_rejected");
	to_el.classList.remove("to_repl")
	to_el.classList.add("to_rejected")
	console.log("applied reject")	
}



function get_repl_pair(cur_id){
	cur_el=$$(cur_id)
  cur_el_name=cur_el.getAttribute("name");
  return cur_el_name
	// from_el=cur_el.getElementsByClassName("from_repl")[0]
	// to_el=cur_el.getElementsByClassName("to_repl")[0]
	// return [from_el.innerHTML,to_el.innerHTML]
	//console.log(from_el,to_el)
}

function get_all_tentative_ids(){
  //elements with tentative class and their ids
  cur_classes=get_class_el_items(".tentative")
  var temp_list=[]
  for (it0 of cur_classes) {
     if (it0.id=="" || it0.id==null) continue
     if (it0.classList.contains("human")) continue
     temp_list.push(it0.id) 
  } 
  return temp_list
}

function update_counts(){
  // displayed_el_i=str(el_i+1)
  // $$("cur_repl_number").innerHTML=""
}

function display_counts(){
  displayed_el_i=str(el_i+1)
  if (len(el_list)==0) displayed_el_i="0"
  $$("cur_repl_number").innerHTML=displayed_el_i
  $$("repl_count").innerHTML=str(len(el_list))

}

function select_el(el_id){
  $(".selected").removeClass("selected");
  $("#"+el_id).addClass("selected")
  scroll2el($$(el_id))
  //scroll2el()
  //remove slected from any element
  //scroll2el
  //update with selected
}




</script>

<body onload="init()">


<div class="container">

<nav class="navbar fixed-top navbar-light bg-light">
  <span class="navbar-brand mb-0 h5">Pre-editing Dashboard</span>
  <span class="navbar-brand mb-0 h1">
          <button type="button" class="btn btn-primary" onclick="go2prev_repl()">&laquo;</button>
            <span id="cur_repl_number">5</span>/
            <span id="repl_count">12</span>

          <button type="button" class="btn btn-primary" onclick="go2next_repl()">&raquo;</button>  
</span>
  <span class="navbar-brand mb-0 h1">
    <button type="button" class="btn btn-success" onclick="accept_repl()">Accept</button>
    <button type="button" class="btn btn-danger" onclick="reject_repl()">Reject</button>
    <button type="button" class="btn btn-info" onclick="undo_repl()">Undo</button>





<!--     <div class="form-check">
  <input class="form-check-input" type="checkbox" value="" id="flexCheckChecked" checked disabled>
  <label class="form-check-label" for="flexCheckChecked">
    <small class="text-muted">Apply to identical</small>
  </label>

</div> -->

  </span>
</nav>
<div class="mx-auto" style="height: 100px;">
  -
</div>

  <h2 hidden>Pre-editing Data Display</h2>
  <p hidden>Displaying editing information.</p>

  <!-- <div id="testing" class="mt-10">
    <span class="from_repl">What</span><span class="to_repl">Who</span> <span class="to_appoved">to_appoved</span> <span class="to_rejected">to_rejected</span> <span class="from_appoved">from_appoved</span> <span class="from_rejected">from_rejected</span>

              <span id="13213" class="tentative">
                <span class="from_repl">What</span> <span class="to_repl">Who</span>
              </span>

              <span id="233" class="tentative">
                <span class="from_repl">Where</span> <span class="to_repl">There</span>
              </span>

              <span id="12233" class="tentative">
                <span class="from_repl">Where</span> <span class="to_repl">There</span>
              </span>

              <span id="0003132" class="tentative">
                <span class="from_repl">When</span> <span class="to_repl">Then</span>
              </span>

              <span id="1321300" class="tentative">
                <span class="from_repl">What</span> <span class="to_repl">Who</span>
              </span>

  </div> -->

  <table class="table table-responsive w-100 d-block d-md-table" id="data_display_table">
    <thead id="data_table_headers"><tr><th>Output</th></tr></thead>
    <tbody id="data_display_table_body"><tr class="table-light" name="word/document.xml|39ea16f80e"><td></td></tr><tr class="table-dark text-dark" name="word/document.xml|2c271bb7ed"><td></td></tr><tr class="table-light" name="word/document.xml|71ef5ea3bc"><td></td></tr><tr class="table-dark text-dark" name="word/document.xml|b3639fb1e8"><td></td></tr><tr class="table-light" name="word/document.xml|4e378a43c7"><td></td></tr><tr class="table-dark text-dark" name="word/document.xml|e5a1579732"><td></td></tr><tr class="table-light" name="word/document.xml|1581527a8c"><td></td></tr><tr class="table-dark text-dark" name="word/document.xml|9e89ae68eb"><td></td></tr><tr class="table-light" name="word/document.xml|0cf9d49f9d"><td>In the name of God, the most Compassionate, the most Merciful</td></tr><tr class="table-dark text-dark" name="word/document.xml|7e510e3c98"><td>No. 3 January 2023</td></tr><tr class="table-light" name="word/document.xml|50fefe8e76"><td>Excellency,</td></tr><tr class="table-dark text-dark" name="word/document.xml|a0096d0d08"><td>I would like to draw your attention to Israel's ongoing breaches of international law and the <span id="94EL" class="replacement automatic delete tentative" name="the UN Charter | the Charter"><span class="from_repl from_initial">UN</span> <span class="to_repl to_initial"></span></span> Charter against the Islamic Republic of Iran. The Israeli regime continues to threaten to use force against Iran, the most recent of which are statements made by regime authorities openly threatening to use force against Iran's peaceful nuclear <span id="ZZ7P" class="replacement automatic replace tentative" name="programs | programmes"><span class="from_repl from_initial">programs</span> <span class="to_repl to_initial">programmes</span></span> .</td></tr><tr class="table-light" name="word/document.xml|7d13b5a776"><td>On 28 December 2022, Benny Gantz, outgoing Defense Minister of the Israeli regime, declared, “Israel has significantly increased its preparedness in recent years and is preparing for the possibility of an attack on Iran”. Similarly, Yair Lapid, departing Prime Minister of the Israeli regime, repeated the same hostile tone and claimed, “ No Israeli Government will allow a nuclear Iran. If it is necessary to act, we will act”. Furthermore, on 27 December 2022, Aviv Kohavi, Chief of Staff of the Israeli regime, remarked, “The level of preparedness for an operation in <span id="NPS2" class="replacement automatic insert tentative" name="in Iran | in the Islamic Republic of Iran"><span class="from_repl from_initial"></span> <span class="to_repl to_initial">the Islamic Republic of</span></span> Iran has dramatically improved.”</td></tr><tr class="table-dark text-dark" name="word/document.xml|c3c3293066"><td>These inflammatory and belligerent statements threatening to use force against Iran's peaceful nuclear <span id="S8UQ" class="replacement automatic replace tentative" name="programs | programmes"><span class="from_repl from_initial">programs</span> <span class="to_repl to_initial">programmes</span></span> , which have been under the most stringent and intrusive nuclear verification, monitoring and transparency measures ever implemented in a country in <span id="JT8A" class="replacement automatic delete tentative" name="in the IAEA | in IAEA"><span class="from_repl from_initial">the</span> <span class="to_repl to_initial"></span></span> IAEA's history, are a flagrant violation of international law and the <span id="2350" class="replacement automatic insert tentative" name="the United | the Charter of the United"><span class="from_repl from_initial"></span> <span class="to_repl to_initial">Charter of the</span></span> United Nations <span id="3SUP" class="replacement automatic delete tentative" name="Nations Charter, | Nations,"><span class="from_repl from_initial">Charter</span> <span class="to_repl to_initial"></span></span> , specifically Article 2 (4) of the Charter.</td></tr><tr class="table-light" name="word/document.xml|0d09b50518"><td>This is not the first time the Israeli regime has threatened to use force against Iran. As emphasized in Iran's letter dated 27 July 2022 (S/2022/581), this regime has already blatantly and openly admitted its responsibility for the terrorist and destructive operations committed against Iranian officials, scientists, civilians <span id="J4YC" class="replacement automatic delete tentative" name="civilians, and | civilians and"><span class="from_repl from_initial">,</span> <span class="to_repl to_initial"></span></span> and its peaceful nuclear infrastructure by this illegitimate regime inside Iranian territory in recent years. Indeed, such warmongering statements demonstrate that the Israeli regime is responsible for all criminal and terrorist acts committed against Iran and must bear the consequences.</td></tr><tr class="table-dark text-dark" name="word/document.xml|5b4bc211c0"><td>While warning against the Israeli regime's military adventurism against Iran in order to pursue its malign policies in the region, the Islamic Republic of Iran reserves its legitimate right, in accordance with international law and the <span id="FSGJ" class="replacement automatic insert tentative" name="the United | the Charter of the United"><span class="from_repl from_initial"></span> <span class="to_repl to_initial">Charter of the</span></span> United Nations Charter <span id="ZQLR" class="replacement automatic insert tentative" name="Charter, | Charter of the United Nations,"><span class="from_repl from_initial"></span> <span class="to_repl to_initial">of the United Nations</span></span> , to respond to any threat posed by the Israeli regime and protect its people as well as national security interests at any time it deems appropriate.</td></tr><tr class="table-light" name="word/document.xml|65d3c40e2f"><td>The United Nations Security Council must uphold its Charter responsibility in the maintenance of international peace as well as security and condemn the Israeli regime's warmongering statements and malevolent activities, which are a real threat to international peace and security. This regime must be forced to comply with international law and abandon its dangerous plans for the region.</td></tr><tr class="table-dark text-dark" name="word/document.xml|327966bd20"><td>I should be grateful if you would have the present letter circulated as a document of the Security Council.</td></tr><tr class="table-light" name="word/document.xml|7920f3fb89"><td>Please accept, Excellency, the assurances of my highest consideration.</td></tr><tr class="table-dark text-dark" name="word/document.xml|df583d6982"><td>Amir Saeid Iravani</td></tr><tr class="table-light" name="word/document.xml|6e175839b4"><td>Ambassador</td></tr><tr class="table-dark text-dark" name="word/document.xml|e7a30d1dfe"><td>Permanent Representative</td></tr><tr class="table-light" name="word/document.xml|7d79c1d21b"><td>H.E. Mr. Antonio Guterres</td></tr><tr class="table-dark text-dark" name="word/document.xml|4a9d7363dc"><td>Secretary-General</td></tr><tr class="table-light" name="word/document.xml|f825904d6d"><td>United Nations, New York</td></tr><tr class="table-dark text-dark" name="word/document.xml|1a9d1be367"><td>H.E. Mr. Ishikane KimihiroISHIKANE Kimihiro,</td></tr><tr class="table-light" name="word/document.xml|bb14168da6"><td>President of the Security Council</td></tr><tr class="table-dark text-dark" name="word/document.xml|873573d8d3"><td>United Nations, New York</td></tr><tr class="table-light" name="word/footnotes.xml|7df3f70a13"><td>https://www.timesofisrael.com/gantz-tells-graduating-pilots-they-could-be-flying-to-attack-iran-in-2-3-years/</td></tr><tr class="table-dark text-dark" name="word/footnotes.xml|6e86b23080"><td>https://www.jns.org/lapid-israel-will-use-force-to-prevent-iran-from-going-nuclear/</td></tr><tr class="table-light" name="word/footnotes.xml|944a49c81b"><td>https://www.jpost.com/arab-israeli-conflict/article-725920</td></tr><tr class="table-dark text-dark" name="word/footer1.xml|1caea10a5f"><td></td></tr></tbody>
  </table>

  <div class="footer_spacer"></div>
  <footer class="fixed-bottom">
    <div class="row">
      <div class="col text-center">
        <div class="mt-3">Current Replacement: </div>
      </div>
      <div class="col text-center">
        <div id="cur_repl_display" class="mt-3" style="background-color: lightblue">This ⇨ That </div>
        
      </div>
      <div class="col">
        <button type="button" class="btn btn-success mt-2" onclick="accept_repl_all()">Accept All</button>
        <button type="button" class="btn btn-danger mt-2" onclick="reject_repl_all()">Reject All</button>        
      </div>
      <div class="col text-right">

        <button type="button" class="btn btn-info btn-lg m-2">Export
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-arrow-up-right-square" viewBox="0 0 16 16">
            <path fill-rule="evenodd" d="M15 2a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2zM0 2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2zm5.854 8.803a.5.5 0 1 1-.708-.707L9.243 6H6.475a.5.5 0 1 1 0-1h3.975a.5.5 0 0 1 .5.5v3.975a.5.5 0 1 1-1 0V6.707l-4.096 4.096z"/>
          </svg>
        </button>
      </div>
    </div>
  </footer>

<!--   <div class="footer fixed-bottom">Footer</div> -->
</div>

</body>
</html>

